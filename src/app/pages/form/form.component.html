<mat-card class="example-card">
    <mat-card-header> </mat-card-header>
    <form autocomplete="off" novalidate [formGroup]="form" (submit)="save()">
        <mat-card-content>
            <!-- Firstname -->
            <mat-form-field appearance="outline">
                <mat-label>Firstname *</mat-label>
                <input matInput type="text" id="firstName" formControlName="firstName" />
                @if (form.invalid) {
                <mat-error>{{
                    getErrorMessage("firstName", form)
                    }}</mat-error>
                }
            </mat-form-field>

            <!-- Lastname -->
            <mat-form-field appearance="outline">
                <mat-label>LastName *</mat-label>
                <input matInput type="text" id="lastName" formControlName="lastName" />
                @if (form.invalid) {
                <mat-error>{{
                    getErrorMessage("lastName", form)
                    }}</mat-error>
                }
            </mat-form-field>

            <mat-form-field>
                <mat-label>Favorite Fruits</mat-label>
                <mat-chip-grid #chipGrid formArrayName="fruits">
                    @for (
                    fruit of fruits.controls;
                    track fruit;
                    let i = $index
                    ) {
                    <mat-chip-row (removed)="remove(i)">
                        {{ fruit.value }}
                        <button matChipRemove>
                            <mat-icon>cancel</mat-icon>
                        </button>
                    </mat-chip-row>
                    }
                </mat-chip-grid>

                <input #fruitInput placeholder="New Fruit..." (matChipInputTokenEnd)="add($event)"
                    [matChipInputAddOnBlur]="addOnBlur" [matChipInputFor]="chipGrid" [matAutocomplete]="fruitsAutocomplete"
                    formControlName="fruitInput" />
                <mat-autocomplete #fruitsAutocomplete="matAutocomplete" (optionSelected)="selected($event);">
                    @for(fruit of filteredFruits | async;track fruit){
                    <mat-option [value]="fruit">
                        {{fruit}}
                    </mat-option>
                    }

                </mat-autocomplete>
            </mat-form-field>

            <!-- Submit -->
            <div class="button-wrapper">
                <button mat-flat-button color="primary">Submit</button>
            </div>
        </mat-card-content>

        <mat-divider></mat-divider>

        <mat-card-actions align="end">
            <button type="submit" color="primary" mat-raised-button
                [disabled]="!form.valid && (form.dirty || form.untouched)">
                SAVE
            </button>
        </mat-card-actions>
    </form>
    <mat-card-footer>
        <pre>{{ form.value | json }}</pre>
    </mat-card-footer>
</mat-card>